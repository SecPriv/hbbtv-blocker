# Instructions for testing the HbbTV-enabled channels

## First Step: Reset the Smart TV (if Possible - otherwise skip)

Go to `Settings -> Device Preferences -> Reset`

## Restart the TV

You will be asked to choose the country, the language etc.

When you are asked to connect the TV to a local WiFi, press `skip`

Do the channel search based on whether you are using cable, antenna, or satellite

When you are asked whether you allow Google to access the Location and send diagnostics, select in both cases `No`

## Network Setup

- Connect your laptop to cabled Internet
- Spawn a WiFi hotspot from your laptop:
  - Windows users: https://support.microsoft.com/en-us/windows/use-your-windows-pc-as-a-mobile-hotspot-c89b0fad-72d5-41e8-f7ea-406ad9036b85
  - Ubuntu/Linux users: https://www.geeksforgeeks.org/creating-and-configuring-wi-fi-hotspot-in-ubuntu/
- if the TV is connected to the Internet, please, disconnect it

## Get to the Channel You Want to Test - 20 mins (`before_consent`)

- Search for the channel you want to test.
- Start an instance of Wireshark listening on the hotspot interface
- Connect the TV to the hotspot by pressing the `settings` button on the remote controller
- You might be prompted with a privacy policy banner, **do not interact with it**; just listen with Wireshark for 20 mins (we call this section `before_consent`)

## Channel Interaction - 40 mins (`consent_given`)

- After 20 minutes have elapsed, **Accept the privacy policy** (if any) and accept **ALL** cookies! If no policy is present, just start interacting with the channel
- Start playing around with the HbbTV application (you will probably have to press the red button to start it)
- Try to explore as much of the app as possible, different sub-menus, fill-in fields etc
- IMPORTANT: do not change the privacy settings (do not revoke consent!!), do not change the channel nor go to the TV menu, as this will create a bunch of "fake" requests that are not generated by the HbbTV app.

## Revoking consent - 15 mins (`consent_revoked`)

- After the 40 mins have elapsed, navigate the app till you find a sub-menu where you can either refuse the privacy policy or unselect the cookies used by the application. It might also be that this selection window only appears if pressing the blue button on the remote. 
- After consent is revoked, listen for 15 mins without interaction.
- NOTE: In some cases, the apps do not allow revoking consent; in these cases, just listen for 15 without interaction.

## Consent Again - 15 mins (`consent_again`)

- Go back to the privacy page where you can select cookies and give consent (if present); give consent again, turn the tv off and on and listen for 15 mins without interaction.
- After this time has elapsed, you can stop Wireshark.

### GENERAL REMARKS

- We have a single PCAP file for the whole test; We set timers after 20-40-15-15 minutes (tot 1h30) to remind of the different steps. But if this approach does not work for you, you can also have four different PCAPs with pre-defined time limits (e.g., only 20 mins, and then the capture stops)
- If a channel does not offer ANY HbbTV functionalities, but there are still some requests from it in the background, just listen for 20 minutes. 
